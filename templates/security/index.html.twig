<!DOCTYPE html>
<html lang="fr">

<head>
    <title>Login</title>

    <!-- Meta tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- Google fonts -->
    <link href="//fonts.googleapis.com/css2?family=Kumbh+Sans:wght@300;400;700&display=swap" rel="stylesheet">

    <!-- CSS Stylesheet -->
    <link rel="stylesheet" href="{{asset('login_form/css/style.css')}}" type="text/css" media="all" />
    <style>
    .alert-success {
        color: #155724;
        background-color: #d4edda;
        border-color: #c3e6cb;
    }
    .alert {
        position: relative;
        padding: .75rem 1.25rem;
        margin-bottom: 1rem;
        border: 1px solid transparent;
        border-radius: .25rem;
    }
    </style>

</head>

<body>
    <div class="signinform">
        <h1>MDB</h1>
        <!-- container -->
        <div class="container">
            <!-- main content -->
            <div class="w3l-form-info">
                <div class="w3_info">
                    <h2>Se connecter</h2>
                    <form action="#" method="post">
                        {% if error %}
                            <div class="alert alert-danger">{{ error.messageKey|trans(error.messageData, 'security') }}</div>
                        {% endif %}
                        {% if app.user %}
                            <div class="mb-3">
                                You are logged in as {{ app.user.userIdentifier }}, <a href="{{ path('app_logout') }}">Logout</a>
                            </div>
                        {% endif %}
                        {% if retour != '' %}
                            <div class="mb-3">
                                <div class="alert alert-success" role="alert">
                                    {{retour}}
                                </div>
                            </div>
                        {% endif %}
                        <div class="input-group">
                            <span><i class="fas fa-user" aria-hidden="true"></i></span>
                            <input type="text" value="{{ last_username }}" placeholder="Username or email" name="username" required="">
                        </div>
                        <div class="input-group">
                            <span><i class="fas fa-key" aria-hidden="true"></i></span>
                            <input type="Password" placeholder="Password" name="password" required="">
                        </div>
                        <input type="hidden" name="_csrf_token"
                            value="{{ csrf_token('authenticate') }}"
                        >
                        <div class="form-row bottom">
                            <div class="form-check">
                                <input type="checkbox" id="remenber" name="_remember_me">
                                <label for="remenber"> Se souvenir de moi</label>
                            </div>
                            <a href="#url" class="forgot">Mot de passe oubli√©?</a>
                        </div>
                        <button class="btn btn-primary btn-block" type="submit">Se connecter</button>
                    </form>
                    <p class="continue"><span>ou se connecter avec</span></p>
                    <div class="social-login">
                        <a href="#facebook" onclick="fb_login();">
                            <div class="facebook">
                                <span class="fab fa-facebook-f" aria-hidden="true"></span>

                            </div>
                        </a>
                        <a href="{{path('app_loginGithub')}}">
                            <div class="github">
                                <span class="fab fa-github" aria-hidden="true"></span>
                            </div>
                        </a>
                        <a href="{{ path('hwi_oauth_service_redirect', {'service': 'google' }) }}">
                            <div class="google">
                                <span class="fab fa-google" aria-hidden="true"></span>
                            </div>
                        </a>
                    </div>
                    <p class="account">Pas encore membre? <a href="{{path('app_user_new')}}">S'inscrire</a></p>
                </div>
            </div>
            <!-- //main content -->
        </div>
        <!-- //container -->
        {# Bonus: Show all available login link in HWIOAuthBundle #}

        <!-- footer -->
        <div class="footer">
            <p>&copy; 2022 MDB. All Rights Reserved | Design by <a href="https://w3layouts.com/"
                    target="blank">W3layouts</a></p>
        </div>
        <!-- footer -->
    </div>

    <!-- fontawesome v5-->
    <script src="{{asset('login_form/js/fontawesome.js')}}"></script>

     <script>
        window.fbAsyncInit = function() {
            // init the FB JS SDK
            FB.init({
                appId      : '427095729440722%',                        // App ID from the app dashboard
                channelUrl : 'https://test1',      // Channel file for x-domain comms
                status     : true,                                 // Check Facebook Login status
                xfbml      : true                                  // Look for social plugins on the page
            });
        };

        // Load the SDK asynchronously
        (function(d, s, id){
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/all.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));

        function fb_login() {
            FB.getLoginStatus(function(response) {
                if (response.status === 'connected') {
                    // connected
                    alert('Already connected, redirect to login page to create token.');
                    document.location = "{{ url("hwi_oauth_service_redirect", {service: "facebook"}) }}";
                } else {
                    // not_authorized
                    FB.login(function(response) {
                        if (response.authResponse) {
                            document.location = "{{ url("hwi_oauth_service_redirect", {service: "facebook"}) }}";
                        } else {
                            alert('Cancelled.');
                        }
                    }, {scope: 'email'});
                }
            });
        }
    </script>

</body>

</html>